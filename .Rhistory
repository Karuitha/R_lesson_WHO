janitor,
countrycode,
sf,
remotes,
geojsonsf
)
# Load required packages ----
if (!require(pacman)) {
install.packages("pacman")
}
library(pacman)
p_load(
tidyverse,
plotly,
ggthemes,
skimr,
janitor,
countrycode
)
p_load_gh(
"datarootsio/artyfarty"
)
# Get WB Classifications data ----
world_bank <- read.csv(
"world-bank-income-groups.csv"
) |>
dplyr::filter(
Year == 2024
) |>
janitor::clean_names() |>
dplyr::select(
code,
world_bank_s_income_classification
) |>
rename(
income_class = world_bank_s_income_classification
)
# Get maps data ----
map_data("world") |>
mutate(
code = countrycode(
sourcevar = region,
origin = "country.name",
destination = "iso3c"
)
) |>
left_join(
world_bank
) |>
ggplot(
aes(x = long, y = lat, group = group, fill = income_class)
) +
geom_polygon(show.legend = FALSE, color = "black") +
labs(
x = "",
y = "",
title = "World Map World Bank Income Classifications in R"
) +
theme_scientific() +
theme(
axis.text = element_blank()
) +
scale_fill_fivethirtyeight()
# Get maps data ----
map_data("world") |>
mutate(
code = countrycode(
sourcevar = region,
origin = "country.name",
destination = "iso3c"
)
) |>
left_join(
world_bank
) |>
ggplot(
aes(x = long, y = lat, group = group, fill = income_class)
) +
geom_polygon(show.legend = FALSE, color = "black") +
labs(
x = "",
y = "",
title = "World Map World Bank Income Classifications in R",
caption = "John Karuitha; 2025"
) +
theme_scientific() +
theme(
axis.text = element_blank()
) +
scale_fill_fivethirtyeight()
# Get maps data ----
map_data("world") |>
mutate(
code = countrycode(
sourcevar = region,
origin = "country.name",
destination = "iso3c"
)
) |>
left_join(
world_bank
) |>
ggplot(
aes(x = long, y = lat, group = group, fill = income_class)
) +
geom_polygon(show.legend = FALSE, color = "black") +
labs(
x = "",
y = "",
title = "World Map World Bank Income Classifications in R",
caption = "John Karuitha; 2025"
) +
theme_scientific() +
theme(
axis.text = element_blank()
) +
scale_fill_viridis_d()
p_load_gh("ropensci/rnaturalearth")
install.packages('rnaturalearth')
=========================================================
# =========================================================
# ---- Load Required Packages ----
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
tidyverse,
plotly,
ggthemes,
skimr,
janitor,
countrycode,
sf,
remotes
)
pacman::p_load_gh("datarootsio/artyfarty")
# Load latest rnaturalearth and data package (terra is problematic) ----
p_load_gh("rspatial/terra")
p_load_gh("ropensci/rnaturalearth")
p_load_gh("ropensci/rnaturalearthdata")
world_bank <- read.csv("world-bank-income-groups.csv") %>%
clean_names() %>%
filter(year == 2024) %>%
transmute(
iso3c = code,
income_class = world_bank_s_income_classification
)
world_sf <- rnaturalearth::ne_countries(scale = "medium",
returnclass = "sf") %>%
st_transform(crs = 4326) %>%
select(iso3c = iso_a3, name, geometry)
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = factor(
income_class,
levels = c(
"Low income",
"Lower middle income",
"Upper middle income",
"High income"
)
# ---- Plot Professional Map ----
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_manual(
values = c(
"Low income"          = "#8c2d04",
"Lower middle income" = "#e6550d",
"Upper middle income" = "#fd8d3c",
"High income"         = "#fec44f"
),
na.value = "grey85",
name = "Income Group"
) +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: Your Name"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
# ---- Plot Professional Map ----
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_manual(
values = c(
"Low income"          = "#8c2d04",
"Lower middle income" = "#e6550d",
"Upper middle income" = "#fd8d3c",
"High income"         = "#fec44f"
),
na.value = "grey85",
name = "Income Group"
) +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
world_bank
world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = factor(
income_class,
levels = c(
"Low income",
"Lower middle income",
"Upper middle income",
"High income"
)
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_distiller() +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_viridis_d() +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
world_joined
world_sf %>%
left_join(world_bank, by = "iso3c")
world_sf
world_joined |> tail()
ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15)
ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_manual(
values = c(
"Low income"          = "#8c2d04",
"Lower middle income" = "#e6550d",
"Upper middle income" = "#fd8d3c",
"High income"         = "#fec44f"
),
na.value = "grey85",
name = "Income Group"
)
# ---- Plot Professional Map ----
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_manual(
values = c(
"Low income"          = "#8c2d04",
"Lower middle income" = "#e6550d",
"Upper middle income" = "#fd8d3c",
"High income"         = "#fec44f"
),
name = "Income Group"
) +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
View(world_joined)
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = factor(
income_class,
levels = c(
"Low income",
"Lower middle income",
"Upper middle income",
"High income"
)
world_sf
world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = factor(
income_class,
levels = c(
"Low income",
"Lower middle income",
"Upper middle income",
"High income"
)
world_sf %>%
left_join(world_bank, by = "iso3c")
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c")
table(world_joined$income_class)
world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries")
)
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries")
)
table(world_joined$income_class)
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries")
)
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries")
)
bbbbb
ZZZZZ
world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries") |>
str_squish()
) |>
mutate(
income_class = factor(
income_class,
levels = c(
"Low-income",
"Lower middle-income",
"Upper-middle-income",
"High-income"
)
world_sf %>%
left_join(world_bank, by = "iso3c")
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries") |>
str_squish()
)
# ---- Plot Professional Map ----
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_manual(
values = c(
"Low income"          = "#8c2d04",
"Lower middle income" = "#e6550d",
"Upper middle income" = "#fd8d3c",
"High income"         = "#fec44f"
),
na.value = "grey85",
name = "Income Group"
) +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
world_joined
world_joined <- world_sf %>%
left_join(world_bank, by = "iso3c") %>%
mutate(
income_class = str_remove_all(income_class, " countries") |>
str_squish()
)
ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
)
ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_viridis_d()
ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
scale_fill_viridis_d() +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15)
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
p <- ggplot(world_joined) +
geom_sf(aes(fill = income_class), color = "grey35", linewidth = 0.15) +
labs(
title = "World Bank Income Classifications (2024)",
subtitle = "Mapped using R and high-resolution Natural Earth data",
caption = "Source: World Bank | Visualization: John Karuitha, 2025"
) +
theme_minimal(base_size = 14) +
theme(
legend.position = "bottom",
legend.title = element_text(face = "bold"),
panel.background = element_rect(fill = "aliceblue", color = NA),
panel.grid = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
plot.title = element_text(face = "bold", size = 20),
plot.subtitle = element_text(size = 12)
) +
coord_sf(expand = FALSE)
p
